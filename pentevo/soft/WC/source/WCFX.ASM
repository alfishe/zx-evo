;---------------------------------------F36     CALL F3:LD A,1:JR NZ,SBN        CALL F4:LD A,2:JR NZ,SBN        CALL F6:LD A,3:JR NZ,SBN        CALL CLAVA:JR Z,F36E        CP "r":CALL Z,SEXYF36E    LD A,1:OR A        RETSBN     CP (IX+35):JR NZ,$+3:XOR A        LD (IX+35),A        CALL SEXY        JR F36E;---------------------------------------Mark    CALL GETEN:JP Z,CRDN        EX DE,HL        LD DE,0-FLG:ADD HL,DE        LD A,(HL)        OR A:LD A,MARKclr:JR Z,$+3:XOR A        LD (HL),A        LD L,(IX+16)        LD H,(IX+17)        PUSH HL        CALL CRDN        POP HL        LD E,(IX+16)        LD D,(IX+17):OR A:SBC HL,DE        RET NZ        CALL CURSER,WLIT        JP CURSORIMrk    CALL GETEN:RET Z        EX DE,HL        LD DE,0-FLG:ADD HL,DE        LD A,(HL)        OR A:LD A,MARKclr:JR Z,$+3:XOR A        LD (HL),A        CALL WLIT        LD A,1,(MRCT),A:OR A        RET;---------------------------------------STATUS  XOR A:LD HL,STUS:CP (HL):RET Z        LD (HL),A        CALL ARAP        LD A,(IX+10):CP 2:RET NZ        CALL GETEN        EXA        LD HL,ENTRY,DE,LOBU,BC,8:LDIR        LD A," ",(DE),A:INC DE        LD C,3:LDIR        LD (DE),A:INC DE        EXA        LD HL,SDIR:JR Z,$+5:LD HL,SFIL        LD C,5:LDIR        LD A,32.7      LD (DE),A:INC DE        EXX        LD HL,(ARRR),DE,(ARRR+2)        PUSH IX        CALL DECZON4        POP IX        DEC DE        LD HL,DE,BC,0-9:ADD HL,BC        LD B,10,A,#30DZF     CP (HL):JR NZ,DzF        LD (HL),32:INC HL        DJNZ DZFDzF     LD HL,DE.3      INC DE        LD A,32        LD BC,3:LDDR        LD (DE),A:DEC DE        LD C,3:LDDR        LD (DE),A:DEC DE        LD C,3:LDDR        LD (DE),A:DEC DE        LD A,(HL),(DE),A        LD A,(IX+5):SUB 2_LD HL,LOBU,D,A,E,1,BC,38:JP PRSRW;-------R2B2    CALL ENKE:JP NZ,EXTZEL        CALL F3:JP NZ,EXTZEL        LD A,1:OR A        RET;-------F12     CALL F1:JR NZ,SLM        CALL F2:JR NZ,SRM        JR BER;-------SLM     LD HL,WINDOW:JR $+5SRM     LD HL,WINDO2        CALL SXM:INC B:JR Z,BER        PUSH IX        LD IX,(IXHL),(IX+29),A,(IX+28),0        CALL DRACT,ORIGA        POP IX        CALL DRACTBER     LD A,1:OR A        RET;-------SXM     ;i:HL - SOW, IX - SOW(now);        o: A - CurPoz-1        PUSH IX        PUSH HL:CALL CURSER:POP HL        LD (IXHL),HL        PUSH HL        POP IY        LD IX,DSWND        LD A,(IY+2):ADD A,2:LD (IX+2),A        LD A,(IY+3):ADD A,2:LD (IX+3),A        LD A,(IY+29):INC A:LD (IX+12),A        CALL PRWOWSMC     EI:HALT:CALL CURSOR        CALL UPPP,NZ,CrUP        CALL DWWW,NZ,CrDN        CALL ESC:LD B,#FF:JR NZ,AMC        CALL ENKE:JR Z,SMC        LD B,0AMC     PUSH BC        CALL RRESB        POP BC        LD A,(IX+12):DEC A        POP IX        RET;---------------------------------------HELP    PUSH IX        LD IX,HPWND:CALL PRWOW        CALL Confa        CALL USPO        CALL NUSP        CALL RRESB        POP IX        RET;-------Confa   CALL FROZEN        LD HL,LOBU+16,B,32:CALL NOPING        LD HL,LOBU,DE,LOBU+16,BC,12:LDIR        CALL ROZEN_LD HL,LOBU+16,DE,#0307,BC,28:CALL PRSRW        LD A,%01110001:CALL PRIAT        LD HL,IVD,DE,LOBU,BC,14:LDIR        LD A,(CNFv)        LD HL,IVDy        OR A:JR NZ,$+5:LD HL,IVDn        LD BC,8:LDIR_LD HL,LOBU,DE,#040B,BC,22:CALL PRSRW        LD A,%01110000:CALL PRIAT        RET;-------ROZEN   LD A,(HL):AND %00011111        PUSH HL        LD L,A,H,0        CALL DECZ:LD A,".",(DE),A:INC DE        POP HL        LD A,(HL):INC HL        SRL (HL):RRA.4      SRL A        PUSH HL:LD L,A,H,0:CALL DECZ        POP HL        EX DE,HL        LD (HL),".":INC HL        LD (HL),"2":INC HL        LD (HL),"0":INC HL        EX DE,HL        LD A,(HL):AND %00111111        PUSH HL:LD L,A,H,0:CALL DECZ        POP HL        BIT 6,(HL):RET NZ        INC DE        LD HL,BETA,BC,4:LDIR        RET;-------FROZEN  LD BC,#DFF7,A,#F0,E,A:OUT A        LD B,#BF:XOR A:OUT A        LD HL,LOBUFRZ     LD B,#BF:INI:INC E:JR Z,FrZ        LD B,#DF:OUT E        JR FRZFrZ     LD B,#BF,A,2:OUT A        RET;---------------------------------------COPY    CALL CURSER        CALL MARKSRH,Z,IMrk:RET Z        CALL CPDITERM    CALL SWPPAN,DRACT        LD DE,BRRR:CALL TLSTCAT        CALL PANELI,FOLD        CALL SWPPAN,DRACT        RET;*******CPDI    PUSH IX        LD IX,F5WND:CALL PRWOW_LD HL,TXT8,DE,#000D,BC,13:CALL PRSRW        LD A,%11110111:CALL PRIAT        LD HL,(MRCT)        LD DE,TXT9+5:CALL DECZ2_LD HL,TXT9,DE,#020B,BC,18:CALL PRSRW        LD A,1:CALL YNCPM     EI:HALT        XOR A:CALL YN        CALL ENKE:JR NZ,CPGO        CALL ESC:JR Z,CPMCPet    CALL RRESB        POP IX        RET;-------CPGO    LD A,#FF:CALL YN:JR NZ,CPet        POP IX        LD HL,0LENIN   PUSH HL        CALL GETen:LD A,H:OR L:JR Z,CPgo        LD A,(HL):OR A:LD (HL),0        CALL NZ,COPYF:JR NZ,CPgo        POP HL        INC HL        JP LENINCPgo    POP HL        PUSH IX        LD IX,F5WND:CALL RRESB        POP IX        JP WLIT;*******FLOF    CALL NAMEBG        XOR A        LD DE,LOBU+512        LD BC,#26FFFLOf    LDI:CP (HL):JR Z,$+4:DJNZ FLOf        LD A,B:OR A        EX DE,HL:CALL NZ,NOPING        PUSH IX        LD IX,F5WND        LD HL,(MRRN):INC HL:LD (MRRN),HL        LD DE,TXT10+4:CALL DECZ2        LD HL,(MRCT)        LD DE,TXT10+8+4:CALL DECZ2_LD HL,TXT10,DE,#020A,BC,20:CALL PRSRW        LD HL,LOBU+512        LD DE,#0101,BC,#26:CALL PRSRW        LD A,%01110000:CALL PRIAT        POP IX        LD A,(ABT):OR A        RETNAMEBG  EX DE,HL        LD DE,LOBU+4        LD A,(HL):AND #10        XOR #10:LD (DE),A        INC HL,DE        PUSH HL:LD BC,256:LDIR        POP HL        RET;---------------------------------------FEEM    CP 1:LD HL,TER2B:RET Z        CP 2:LD HL,TER2C:RET Z        CP 3:LD HL,TER2D:RET Z        CP 4:LD HL,TER2E:RET Z        CP 8:LD HL,TER2A:RET Z        CP 16:LD HL,TER2:RET Z        LD HL,TER2X        RET;-------RER0    CALL FEEM:JP ERR0;-------CE1     LD HL,TER2A        JR CE0CER0    CALL FEEM        PUSH HL:CALL SWPPAN,DRACT        POP HLCE0     CALL ERR0CEX     LD A,1:OR A        RET;-------COPYF   CALL FLOF,NZ,ABME:JR NZ,CEX        LD HL,LOBU+4        CALL SRHDRN:JR Z,CE1        LD (BRRR),HL,(BRRR+2),DE        LD HL,BRRR:CALL GIPAG        LD DE,ENTRY:CALL TENTRY        CALL SWPPAN,DRACT        LD A,(LOBU+4)        LD HL,ENTRY+28,DE,LOBU+1        LD BC,4:LDIR        LD HL,LOBU,(HL),A        CALL MKfile:JR NZ,CER0        LD A,BUFPG:CALL MNGC        CALL PBSHWSVNG    CALL PBPR        CALL SWPPAN,DRACT        LD HL,#C000        LD B,32:CALL LOAD512        CALL SWPPAN,DRACT        LD HL,#C000        LD B,32:CALL SAVE512        CP #0F:JR NZ,SVNG        CALL PBHTW        CALL SWPPAN,DRACT        XOR A        RET;*******MkDir   CALL CURSER        PUSH IX        LD IX,MDWND:CALL PRWOW        LD HL,TXT6,DE,#0000:CALL TXTPR        LD HL,TCT0,DE,#0101:CALL TXTPR        LD DE,#0106:CALL GADRW        LD (BMKD+1),HL        LD DE,#2100,A,#FF:CALL ISTR        LD HL,#0100,A,#FE:CALL ISTRMKD     EI:HALT        CALL ESC:JR NZ,EMKD        CALL ENKE:JR NZ,BMKD        XOR A:CALL ISTR        LD A,3:CALL ISTR        JR MKD;-------BMKD    LD HL,0        LD DE,LOBU,BC,38-5:LDIR        XOR A:LD (DE),A        LD HL,LOBU:CALL MKdir:JR Z,DMKD        LD HL,TER2F:CALL ERR0DMKD    CALL RRESB        POP IXSEXY    LD DE,BRRR:CALL TLSTCAT        CALL PANELI,FOLD        XOR A        RET;-------EMKD    CALL RRESB        POP IX        RET;*******Move    CALL GETEN:LD A,H:OR L:RET Z        INC DE:LD A,(DE):CP ".":JR NZ,RN        INC DE:LD A,(DE):CP ".":JR NZ,Rn        INC DE:LD A,(DE):OR A:RET Z        DEC DERn      DEC DERN      DEC DE        CALL NAMEBG        CALL CURSER        CALL RENAME:RET Z        LD HL,LOBU+4        LD DE,LOBU+512        CALL RENAM,Z,RER0        JP SEXY;-------RENAME  PUSH IX        PUSH DE        LD HL,MDWND,DE,WINDC,BC,12:LDIR        LD E,(IX+2)        LD D,(IX+3)        LD A,(IX+12):DEC A        LD IX,WINDC        LD (IX+1),0        LD (IX+2),E        ADD A,D:LD (IX+3),A        CALL PRWOW        LD HL,TXT7,DE,#0000:CALL TXTPR        CALL MMM        LD HL,255:EXX        LD HL,LOBU+512        LD DE,#0101        LD BC,#2600        LD A,#FD:CALL ISTR        LD HL,#0100,A,#FE:CALL ISTRREN     EI:HALT        CALL ESC:JR NZ,REM        CALL ENKE:JR NZ,TRIGUN        XOR A:CALL ISTR        LD A,2:CALL ISTR        LD A,3:CALL ISTR        JR RENMMM     LD HL,LOBU+4+1        LD DE,LOBU+512        XOR A        LD BC,#FFFFMmM     LDI:CP (HL):JR Z,$+4:DJNZ MmM        EX DE,HL:LD A," ":JP NOPING+1TRIGUN  LD A,1:CALL ISTR        LD DE,LOBU+512+255        LD B,255TGN     DEC DE:LD A,(DE)        CP " ":JR NZ,$+4:DJNZ TGN        INC DE:XOR A:LD (DE),A        CALL RRESB        POP DE        POP IX        LD A,1:OR A        RETREM     LD A,1:CALL ISTR        CALL RRESB        POP DE        POP IX        XOR A        RET;*******DelFl   CALL CURSER        CALL MARKSRH,Z,IMrk:JR Z,DELDIR        CALL DLDI:RET Z        LD DE,BRRR:CALL TLSTCAT        CALL PANELI,FOLD        RETDELDIR  CALL GETEN:RET NZ        LD A,H:OR L:RET Z        PUSH DE:CALL SAVECD        POP HL        LD DE,LOBU        PUSH DE:LD BC,256:LDIR        POP HL:LD (HL),#10        CALL FENTRY:RET Z        CALL GDIR        LD DE,LOBU+512        CALL NXTETY:JR Z,NED        CALL NXTETY:JR Z,NED        CALL NXTETY:JR NZ,NED        CALL LOADCD        LD HL,LOBU:CALL FNDELFL        JP SEXYNED     LD HL,TER30:CALL ERR0        CALL LOADCD        JP SEXYDLDI    PUSH IX        LD IX,F5WND:CALL PRWOW        LD HL,TXTB,DE,#0000:CALL TXTPR        LD HL,(MRCT)        LD DE,TXTD7:CALL DECZ2        LD HL,TXTD,DE,#0200:CALL TXTPR        LD A,1:CALL YNDLM     EI:HALT        XOR A:CALL YN        CALL ENKE:JR NZ,DLGO        CALL ESC:JR Z,DLMDLet    CALL RRESB        POP IX        XOR A        RET;-------DLGO    LD A,#FF:CALL YN:JR NZ,DLet        LD HL,TXTE,DE,#0400:CALL TXTPR        POP IX        LD HL,0LENIN2  PUSH HL        CALL GETen:LD A,H:OR L:JR Z,DLgo        LD A,(HL):OR A:LD (HL),0        CALL NZ,DELF:JR NZ,DLgo        POP HL        INC HL        JP LENIN2DLgo    POP HL        PUSH IX        LD IX,F5WND:CALL RRESB        POP IX        LD A,1:OR A        RET;-------DER0    LD A,1:OR A        RETDELF    CALL FLOF,NZ,ABME:JR NZ,DER0        LD HL,LOBU+4        CALL DELFL:JR Z,DER0        XOR A        RET;*******ABME    PUSH IX        LD IX,ABWND:CALL PRWOW_LD HL,TXTF,DE,#0000:CALL TXTPR_LD HL,TXTG,DE,#0200:CALL TXTPRMMEN    LD A,1:CALL YNABM     EI:HALT:XOR A:CALL YN        CALL ESC:JR NZ,ESCABM        CALL ENKE:JR Z,ABM        CALL RRESB        LD A,#FF:CALL YN        LD A,#01:JR Z,$+3ABMM    XOR A        POP IX        LD (ABT),A:OR A        RETESCABM  CALL RRESB:JR ABMM;*******DLME    PUSH IX        PUSH HL,DE,BC        LD IX,ABWND:CALL PRWOW        POP BC,DE,HL_CALL TXTPR_LD HL,TXTL,DE,#0000:CALL TXTPR        JR MMEN;---------------------------------------PBSHW   PUSH IX        LD A,(PGC)        PUSH AF        LD IX,PBWND:CALL PRWOW        LD HL,(ENTRY+28)        LD DE,(ENTRY+30)        CALL DEL64        LD (PBSTL+1),HL        LD (PBSTH+1),DE        LD HL,0,(PBNOW),HL,(PBNOW+2),HL        POP AF        CALL MNGC        POP IX        RETPBHTW   PUSH IX        LD IX,PBWND:CALL RRESB        POP IX        RET;-------PBPR    PUSH IX        LD A,(PGC)        PUSH AF        XOR A:CALL MNGC        LD HL,(PBNOW)        LD DE,(PBNOW+2)        LD BC,16384        ADD HL,BC:JR NC,$+3:INC DE        LD (PBNOW),HL        LD (PBNOW+2),DE        CALL DLT4PCH        LD HL,TXTBU        LD A,C,C,64        OR A:JR NZ,$+5:LD A,C:JR DoL        CP C:JR C,$+3:LD A,C        LD B,A        LD A,C:SUB B        LD C,#DB        LD (HL),C:INC HL:DJNZ $-2        OR A:JR Z,DOLDoL     LD B,A,C,#B1        LD (HL),C:INC HL:DJNZ $-2DOL_LD IX,PBWND_LD HL,TXTBU,DE,#0101,BC,64:CALL PRSRW        POP AF        CALL MNGC        POP IX        RET;-------ERR0    ;i:HL - TEXT Message        PUSH IX        PUSH HL:LD IX,ERWND:CALL PRWOW        POP HL        LD DE,#0201:CALL TXTPR        CALL USPO        CALL NUSP        CALL RRESB        POP IX        RET;---------------------------------------EDIT    CALL GETEN:RET Z        LD A,H:OR L:RET Z        CALL TOBUX        LD HL,BRRR:CALL GIPAG        PUSH IX:CALL EDT        POP IX        RET;-------EDT     LD A,PLHPG:CALL MNGC        LD DE,#C000+197-512MTK     LD HL,(PHED)        OR A:SBC HL,DE:RET C        LD HL,512:ADD HL,DE:EX DE,HL        LD A,(DE):CP #14:JR NZ,MTK        LD BC,0-197        JP PLGE;-------TOBUX   EX DE,HL:INC HL        LD DE,BUX        LD BC,256:LDIR        RET;---------------------------------------